%==========================================================================
%   program_revised_by_mxz.m
%   用途：integral
%   使用不同的模型时只需要修改模型代号和模型参数初值即可
%   修订记录：
%   Date              Programer           History
%	==========        ===========         =================================
%	10/09/2008        Chiton.Tsui         revised by Jie BAO
%   17/06/2017                            revised by Xianze Meng
%==========================================================================
format long e;
clear;
clc;
%==========================================================================
% 这一节给定已知变量
%==========================================================================
rho = (6+6)/(25.07*25.78*25.68);%给定密度数值 455/13920.9939;%给定密度数值 540+6+6 n / 16296.903 A  = 0.03304
data=xlsread('anatase101.xlsx','Na-Cl');% sw Ow-Ow, sw Ow-Hw, sw Na-Ow, sw Cl-Ow, sw Na-Cl
r = data(:,1);
for j=2:10
    gr = data(:,j);
    %==========================================================================
    % 原始数据作图
    %==========================================================================
%     figure
    hold on
    figure(1)
    plot(r,gr,'-');
    xlabel('r','Interpreter','latex');
    ylabel('$$g(r)$$','Interpreter','latex');
    % axis([0 1 0 3]);
    %==========================================================================
    n = length(r);%n为实验数据点数
    gt = (r .^ 2) .* gr; %计算gt=r.^2.*gr
    %==========================================================================
%     figure(2)
%     plot(r,gt,'-');
%     xlabel('r','Interpreter','latex');
%     ylabel('$$gt$$','Interpreter','latex');
    % axis([0 1 0 1]);
    %==========================================================================
    for i = 2:n
        nr(i) = 4 .* pi .* rho * trapz(r(1:i),gt(1:i));%计算不同r下的nig（r）
    end
    nrj(:,j-1) = nr';
    r;
    nrj;
    %==========================================================================
    % 绘图过程
    %==========================================================================
    figure(3)
    plot(r,nrj,'-');
    xlabel('r','Interpreter','latex');
    ylabel('$$n_ig(r)$$','Interpreter','latex');
    axis([0 10 0 5]);
    hold off
end
%==========================================================================
% 程序结束
%==========================================================================